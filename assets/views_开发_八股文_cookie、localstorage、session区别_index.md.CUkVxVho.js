import{_ as l,C as a,c as t,o as h,aB as r,G as i}from"./chunks/framework.B_fJ6ASn.js";const y=JSON.parse('{"title":"cookie、localStorage、sessionStorage 区别","description":"","frontmatter":{},"headers":[],"relativePath":"views/开发/八股文/cookie、localstorage、session区别/index.md","filePath":"views/开发/八股文/cookie、localstorage、session区别/index.md","lastUpdated":1765252377000}'),p={name:"views/开发/八股文/cookie、localstorage、session区别/index.md"};function k(o,s,d,g,E,c){const n=a("NolebaseGitContributors"),e=a("NolebaseGitChangelog");return h(),t("div",null,[s[0]||(s[0]=r(`<h1 id="cookie、localstorage、sessionstorage-区别" tabindex="-1">cookie、localStorage、sessionStorage 区别 <a class="header-anchor" href="#cookie、localstorage、sessionstorage-区别" aria-label="Permalink to &quot;cookie、localStorage、sessionStorage 区别&quot;">​</a></h1><h2 id="cookie" tabindex="-1">Cookie <a class="header-anchor" href="#cookie" aria-label="Permalink to &quot;Cookie&quot;">​</a></h2><ul><li>是服务器发送到用户浏览器并保存在本地的一小块数据</li><li>会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上</li><li>通常用于告知服务端两个请求是否来自同一浏览器</li></ul><h2 id="localstorage" tabindex="-1">localStorage <a class="header-anchor" href="#localstorage" aria-label="Permalink to &quot;localStorage&quot;">​</a></h2><ul><li>HTML5 标准中新加入的技术，用于持久化的本地存储</li><li>除非主动删除数据，否则数据是永远不会过期的</li></ul><h2 id="sessionstorage" tabindex="-1">sessionStorage <a class="header-anchor" href="#sessionstorage" aria-label="Permalink to &quot;sessionStorage&quot;">​</a></h2><ul><li>也是 HTML5 标准中新加入的技术，用于本地存储一个会话（session）中的数据</li><li>当用户关闭浏览器窗口后，数据会被删除</li></ul><h2 id="主要区别" tabindex="-1">主要区别 <a class="header-anchor" href="#主要区别" aria-label="Permalink to &quot;主要区别&quot;">​</a></h2><table tabindex="0"><thead><tr><th>特性</th><th>Cookie</th><th>localStorage</th><th>sessionStorage</th></tr></thead><tbody><tr><td><strong>生命周期</strong></td><td>可设置过期时间，默认为浏览器关闭</td><td>永久保存，除非手动清除</td><td>仅在当前会话有效，关闭页面后清除</td></tr><tr><td><strong>存储大小</strong></td><td>约 4KB</td><td>一般 5MB 或更大</td><td>一般 5MB 或更大</td></tr><tr><td><strong>作用域</strong></td><td>同域下共享</td><td>同源（协议+域名+端口）下共享</td><td>仅在当前页面/标签页中共享</td></tr><tr><td><strong>与服务器交互</strong></td><td>每次 HTTP 请求都会携带</td><td>不参与 HTTP 通信</td><td>不参与 HTTP 通信</td></tr><tr><td><strong>API 访问</strong></td><td><code>document.cookie</code></td><td><code>localStorage.setItem()</code> 等</td><td><code>sessionStorage.setItem()</code> 等</td></tr><tr><td><strong>安全性</strong></td><td>可设置 HttpOnly 防止 XSS 攻击</td><td>容易受到 XSS 攻击</td><td>容易受到 XSS 攻击</td></tr></tbody></table><h2 id="使用场景" tabindex="-1">使用场景 <a class="header-anchor" href="#使用场景" aria-label="Permalink to &quot;使用场景&quot;">​</a></h2><h3 id="cookie-适用场景" tabindex="-1">Cookie 适用场景 <a class="header-anchor" href="#cookie-适用场景" aria-label="Permalink to &quot;Cookie 适用场景&quot;">​</a></h3><ul><li>用户身份认证（session_id）</li><li>JWT Token 存储</li><li>个性化设置（主题、语言偏好）</li><li>购物车信息</li><li>追踪用户行为</li></ul><h3 id="localstorage-适用场景" tabindex="-1">localStorage 适用场景 <a class="header-anchor" href="#localstorage-适用场景" aria-label="Permalink to &quot;localStorage 适用场景&quot;">​</a></h3><ul><li>长期保存的用户设置</li><li>离线应用的数据缓存</li><li>保存用户的草稿内容</li><li>记录用户浏览历史</li></ul><h3 id="sessionstorage-适用场景" tabindex="-1">sessionStorage 适用场景 <a class="header-anchor" href="#sessionstorage-适用场景" aria-label="Permalink to &quot;sessionStorage 适用场景&quot;">​</a></h3><ul><li>表单数据的临时保存</li><li>多步骤表单的数据暂存</li><li>页面间传递数据</li><li>防止页面刷新时数据丢失</li></ul><h2 id="代码示例" tabindex="-1">代码示例 <a class="header-anchor" href="#代码示例" aria-label="Permalink to &quot;代码示例&quot;">​</a></h2><h3 id="cookie-操作" tabindex="-1">Cookie 操作 <a class="header-anchor" href="#cookie-操作" aria-label="Permalink to &quot;Cookie 操作&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 设置Cookie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">document.cookie </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &#39;username=John Doe; expires=Thu, 18 Dec 2023 12:00:00 UTC; path=/&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 读取Cookie</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(document.cookie)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 删除Cookie（设置过期时间为过去的时间）</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">document.cookie </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;username=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="localstorage-操作" tabindex="-1">localStorage 操作 <a class="header-anchor" href="#localstorage-操作" aria-label="Permalink to &quot;localStorage 操作&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 设置数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;username&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;John&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;age&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;25&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 读取数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> username</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;username&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;John&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> age</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;age&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;25&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 删除数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">removeItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;username&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 清空所有数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clear</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 存储对象（需要序列化）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;John&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, age: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;user&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(user))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> savedUser</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;user&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="sessionstorage-操作" tabindex="-1">sessionStorage 操作 <a class="header-anchor" href="#sessionstorage-操作" aria-label="Permalink to &quot;sessionStorage 操作&quot;">​</a></h3><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 设置数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sessionStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;step1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;completed&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sessionStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;formData&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;John&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 读取数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> step1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sessionStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;step1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;completed&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> formData</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sessionStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;formData&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 删除数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sessionStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">removeItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;step1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 清空所有数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sessionStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clear</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to &quot;注意事项&quot;">​</a></h2><h3 id="安全考虑" tabindex="-1">安全考虑 <a class="header-anchor" href="#安全考虑" aria-label="Permalink to &quot;安全考虑&quot;">​</a></h3><ol><li><strong>XSS 攻击</strong>：localStorage 和 sessionStorage 容易受到跨站脚本攻击</li><li><strong>CSRF 攻击</strong>：Cookie 可以用于 CSRF 攻击，需要设置 SameSite 属性</li><li><strong>敏感数据</strong>：不要在客户端存储敏感信息</li></ol><h3 id="性能考虑" tabindex="-1">性能考虑 <a class="header-anchor" href="#性能考虑" aria-label="Permalink to &quot;性能考虑&quot;">​</a></h3><ol><li><strong>Cookie 影响性能</strong>：每次 HTTP 请求都会携带 Cookie，增加请求大小</li><li><strong>同步操作</strong>：localStorage 和 sessionStorage 是同步操作，可能阻塞页面</li><li><strong>存储限制</strong>：不同浏览器对存储大小限制不同</li></ol><h3 id="最佳实践" tabindex="-1">最佳实践 <a class="header-anchor" href="#最佳实践" aria-label="Permalink to &quot;最佳实践&quot;">​</a></h3><ol><li>根据数据特点选择合适的存储方式</li><li>重要数据考虑加密存储</li><li>定期清理过期数据</li><li>考虑使用 IndexedDB 处理大量数据存储需求</li></ol><h2 id="token-存储方案对比" tabindex="-1">Token 存储方案对比 <a class="header-anchor" href="#token-存储方案对比" aria-label="Permalink to &quot;Token 存储方案对比&quot;">​</a></h2><h3 id="为什么-token-通常存储在-cookie-中" tabindex="-1">为什么 Token 通常存储在 Cookie 中 <a class="header-anchor" href="#为什么-token-通常存储在-cookie-中" aria-label="Permalink to &quot;为什么 Token 通常存储在 Cookie 中&quot;">​</a></h3><h4 id="_1-自动携带机制" tabindex="-1">1. 自动携带机制 <a class="header-anchor" href="#_1-自动携带机制" aria-label="Permalink to &quot;1. 自动携带机制&quot;">​</a></h4><ul><li><strong>Cookie</strong>：每次 HTTP 请求会自动携带到服务器，无需手动处理</li><li><strong>localStorage</strong>：需要手动将 Token 添加到请求头中（如 <code>Authorization: Bearer token</code>）</li></ul><h4 id="_2-安全性优势" tabindex="-1">2. 安全性优势 <a class="header-anchor" href="#_2-安全性优势" aria-label="Permalink to &quot;2. 安全性优势&quot;">​</a></h4><ul><li><strong>HttpOnly Cookie</strong>：可以设置 <code>HttpOnly</code> 属性，防止 JavaScript 访问，有效防止 XSS 攻击</li><li><strong>SameSite Cookie</strong>：可以设置 <code>SameSite</code> 属性，防止 CSRF 攻击</li><li><strong>Secure Cookie</strong>：可以设置 <code>Secure</code> 属性，仅在 HTTPS 下传输</li></ul><h4 id="_3-跨域处理" tabindex="-1">3. 跨域处理 <a class="header-anchor" href="#_3-跨域处理" aria-label="Permalink to &quot;3. 跨域处理&quot;">​</a></h4><ul><li><strong>Cookie</strong>：支持跨域请求时的自动携带（需要配置 CORS）</li><li><strong>localStorage</strong>：受同源策略限制，跨域访问更复杂</li></ul><h4 id="_4-服务器端控制" tabindex="-1">4. 服务器端控制 <a class="header-anchor" href="#_4-服务器端控制" aria-label="Permalink to &quot;4. 服务器端控制&quot;">​</a></h4><ul><li><strong>Cookie</strong>：服务器可以设置过期时间、路径、域名等属性</li><li><strong>localStorage</strong>：完全由客户端控制</li></ul><h3 id="token-存储方案对比表" tabindex="-1">Token 存储方案对比表 <a class="header-anchor" href="#token-存储方案对比表" aria-label="Permalink to &quot;Token 存储方案对比表&quot;">​</a></h3><table tabindex="0"><thead><tr><th>存储方式</th><th>优势</th><th>劣势</th><th>适用场景</th></tr></thead><tbody><tr><td><strong>Cookie</strong></td><td>自动携带、HttpOnly 防护、服务器控制</td><td>增加请求体积、CSRF 风险</td><td>传统 Web 应用、需要高安全性的场景</td></tr><tr><td><strong>localStorage</strong></td><td>容量大、不自动携带、API 简单</td><td>XSS 攻击风险、需手动处理</td><td>单页应用、移动端应用</td></tr><tr><td><strong>sessionStorage</strong></td><td>会话隔离、关闭即清除</td><td>不适合长期存储</td><td>临时 token、单次会话认证</td></tr></tbody></table><h3 id="最佳实践建议" tabindex="-1">最佳实践建议 <a class="header-anchor" href="#最佳实践建议" aria-label="Permalink to &quot;最佳实践建议&quot;">​</a></h3><h4 id="使用-cookie-存储-token-时的安全配置" tabindex="-1">使用 Cookie 存储 Token 时的安全配置： <a class="header-anchor" href="#使用-cookie-存储-token-时的安全配置" aria-label="Permalink to &quot;使用 Cookie 存储 Token 时的安全配置：&quot;">​</a></h4><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 服务器端设置 Cookie 时的推荐配置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Set</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Cookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: token</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">your_jwt_token;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">           HttpOnly;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">           Secure;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">           SameSite</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Strict;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">           Path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">           Max</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Age</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3600</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="使用-localstorage-存储-token-时的安全措施" tabindex="-1">使用 localStorage 存储 Token 时的安全措施： <a class="header-anchor" href="#使用-localstorage-存储-token-时的安全措施" aria-label="Permalink to &quot;使用 localStorage 存储 Token 时的安全措施：&quot;">​</a></h4><div class="language-javascript vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 配合 CSRF Token 使用</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> token</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;authToken&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> csrfToken</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getCookie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;csrfToken&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 从 Cookie 获取 CSRF Token</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/data&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  headers: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Authorization: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`Bearer \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">token</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;X-CSRF-Token&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: csrfToken</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="现代应用推荐方案" tabindex="-1">现代应用推荐方案 <a class="header-anchor" href="#现代应用推荐方案" aria-label="Permalink to &quot;现代应用推荐方案&quot;">​</a></h3><p>对于现代前端应用，推荐采用 <strong>混合存储策略</strong>：</p><ol><li><strong>访问令牌（Access Token）</strong>：存储在内存或 sessionStorage 中，短期有效</li><li><strong>刷新令牌（Refresh Token）</strong>：存储在 HttpOnly Cookie 中，用于获取新的访问令牌</li><li><strong>CSRF Token</strong>：存储在 Cookie 中，用于防御 CSRF 攻击</li></ol><p>这种方案既保证了安全性，又提供了良好的用户体验。</p><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><ul><li><strong>Cookie</strong>：适合需要与服务器交互的少量数据存储，特别是身份认证 token</li><li><strong>localStorage</strong>：适合需要长期保存的较大数据，但要注意 XSS 防护</li><li><strong>sessionStorage</strong>：适合会话级别的临时数据存储</li></ul><p>选择合适的存储方式需要考虑数据的生命周期、大小、安全性以及是否需要与服务器交互等因素。对于 token 存储，Cookie 提供了更好的安全性和便利性。</p>`,54)),i(n),i(e)])}const u=l(p,[["render",k]]);export{y as __pageData,u as default};
